<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Document</title>
        <script src="https://cdn.bootcdn.net/ajax/libs/vue/2.6.11/vue.min.js"></script>
        <script src="https://cdn.bootcdn.net/ajax/libs/axios/0.19.2/axios.min.js"></script>
        <script src="https://cdn.bootcdn.net/ajax/libs/vue-router/3.2.0/vue-router.min.js"></script>
        <script src="https://cdn.bootcdn.net/ajax/libs/element-ui/2.13.2/index.js"></script>
        <link href="https://cdn.bootcdn.net/ajax/libs/element-ui/2.13.2/theme-chalk/index.css" rel="stylesheet">
    </head>

    <body>
        <div id="app">
            <el-input placeholder="请输入业务编号进行查询" style="width: 200px;" v-model="condition" clearable>
            </el-input>
            <el-button type="success" @click="getbusiness">查询</el-button>
            <div class="block">
            <el-table :data="tableData" style="width: 1500px"  border @row-click="show">
                <el-table-column fixed prop="bsid" label="业务编号" width="150">
                </el-table-column>
                <el-table-column prop="houseInfo.bunessdetials.bdname" label="业务类型" width="150">
                </el-table-column>
                <el-table-column prop="bsstatus" label="业务状态" width="120">
                </el-table-column> 
                <el-table-column prop="aname" label="申请人" width="120">
                </el-table-column>
                <el-table-column prop="acard" label="身份证件号码" width="300">
                </el-table-column>
                <el-table-column prop="bsdate" label="受理日期" width="150">
                </el-table-column>
                <el-table-column prop="workerInfo.worklevel" label="受理人" width="120">
                </el-table-column>
            </el-table>
            <el-pagination background @size-change="handleSizeChange" :page-size="pageSize" layout="total, sizes, prev, pager, next, jumper"
                    :total="total" @prev-click="toprev" :page-sizes="[5, 10, 15]" :page-size="5"
                    @next-click="tonext" @current-change="topage">
                </el-pagination>
        </div>
        <script>
            new Vue({
                el: "#app",
                data() {
                    return {
                        tableData: [],
                        total: "",
                        pageSize: 5,
                        pageNum: 1,
                        condition: "",
                    }
                },
                mounted() {
                    this.getbusiness();
                },
                methods: {
                    getbusiness(){
                        axios({
                            method: 'get',
                            url: "http://localhost:9000/businessStatus/findAll",
                            params: {
                                pageNum: this.pageNum,
                                pageSize: this.pageSize,
                                key: this.condition
                            }
                        })
                            .then(res => {
                                this.tableData = res.data.list;
                                this.total = res.data.total;
                            })
                            .catch(err => {
                                console.error(err);
                            })
                    },
                    toprev() {
                        this.pageNum = this.pageNum - 1;
                        this.getbusiness();
                    },
                    tonext() {
                        this.pageNum = this.pageNum + 1;
                        this.getbusiness();
                    },
                    topage(val) {
                        this.pageNum = val;
                        this.getbusiness();
                    },
                    indexMethod(index) {
                        console.log(index)
                        return index + (this.pageNum - 1) * this.pageSize + 1;
                    },
                    handleSizeChange(val){
                        this.pageSize = val;
                        this.getbusiness();
                    },
                    show(row, cloumn, event){
                        var storage = window.sessionStorage;
                        storage.setItem("bs", JSON.stringify(row))

                        window.location.href="showinfo.html";
                        
                    }
                },
            }) 
        </script>
    </body>

</html>